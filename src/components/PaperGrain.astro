---
export interface Props {
  intensity?: 'subtle' | 'medium' | 'heavy';
  pattern?: 'dots' | 'grain' | 'fiber';
  className?: string;
}

const { 
  intensity = 'medium',
  pattern = 'grain',
  className = ''
} = Astro.props;

const opacityMap = {
  subtle: '0.15',
  medium: '0.25', 
  heavy: '0.4'
};

const sizeMap = {
  dots: { grain: '80px', fiber: '60px' },
  grain: { grain: '40px', fiber: '30px' },
  fiber: { grain: '120px', fiber: '100px' }
};

const opacity = opacityMap[intensity];
const size = sizeMap[pattern];
---

<div class={`paper-grain ${pattern} ${intensity} ${className}`}>
  {pattern === 'grain' && (
    <div class="grain-overlay" style={`
      background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d4a574' fill-opacity='${opacity}'%3E%3Ccircle cx='5' cy='5' r='0.5'/%3E%3Ccircle cx='25' cy='15' r='0.3'/%3E%3Ccircle cx='15' cy='25' r='0.4'/%3E%3Ccircle cx='35' cy='35' r='0.3'/%3E%3Ccircle cx='8' cy='18' r='0.2'/%3E%3Ccircle cx='32' cy='8' r='0.4'/%3E%3Ccircle cx='18' cy='38' r='0.3'/%3E%3Ccircle cx='38' cy='22' r='0.2'/%3E%3C/g%3E%3C/svg%3E");
      background-size: ${size.grain} ${size.grain};
    `}></div>
  )}
  
  {pattern === 'dots' && (
    <div class="dots-overlay" style={`
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4a574' fill-opacity='${opacity}'%3E%3Ccircle cx='7' cy='7' r='1.5'/%3E%3Ccircle cx='53' cy='13' r='1'/%3E%3Ccircle cx='41' cy='37' r='0.8'/%3E%3Ccircle cx='17' cy='43' r='1.2'/%3E%3Ccircle cx='73' cy='67' r='0.9'/%3E%3Ccircle cx='29' cy='81' r='1.1'/%3E%3Ccircle cx='91' cy='23' r='0.7'/%3E%3Ccircle cx='63' cy='89' r='0.6'/%3E%3Ccircle cx='11' cy='71' r='0.9'/%3E%3Ccircle cx='81' cy='47' r='1.3'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      background-size: ${size.grain} ${size.grain};
    `}></div>
  )}
  
  {pattern === 'fiber' && (
    <div class="fiber-overlay" style={`
      background-image: 
        radial-gradient(circle at 25% 25%, rgba(139, 69, 19, ${parseFloat(opacity) * 0.6}) 0%, transparent 50%),
        radial-gradient(circle at 75% 75%, rgba(160, 82, 45, ${parseFloat(opacity) * 0.8}) 0%, transparent 50%),
        radial-gradient(circle at 50% 50%, rgba(210, 180, 140, ${parseFloat(opacity) * 0.4}) 0%, transparent 50%),
        radial-gradient(circle at 10% 90%, rgba(180, 83, 9, ${parseFloat(opacity) * 0.5}) 0%, transparent 50%);
      background-size: ${size.fiber} ${size.fiber}, 180px 180px, 240px 240px, 160px 160px;
      background-position: 0 0, 60px 60px, 120px 120px, 80px 80px;
    `}></div>
  )}
</div>

<style>
  .paper-grain {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1;
  }

  .grain-overlay,
  .dots-overlay,
  .fiber-overlay {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    mix-blend-mode: multiply;
  }

  .paper-grain.subtle {
    opacity: 0.6;
  }

  .paper-grain.medium {
    opacity: 0.8;
  }

  .paper-grain.heavy {
    opacity: 1;
  }

  /* Enhance the organic feel with slight animation on hover */
  .paper-grain:hover .grain-overlay,
  .paper-grain:hover .dots-overlay {
    animation: subtle-shift 8s ease-in-out infinite;
  }

  @keyframes subtle-shift {
    0%, 100% { transform: translateX(0) translateY(0); }
    25% { transform: translateX(1px) translateY(-1px); }
    50% { transform: translateX(-1px) translateY(1px); }
    75% { transform: translateX(1px) translateY(1px); }
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .paper-grain:hover .grain-overlay,
    .paper-grain:hover .dots-overlay {
      animation: none;
    }
  }
</style>